function rowCells(cols,periodIndex,termStart,startDay){
  const tr=document.createElement('tr');
  cols.forEach(([label,date])=>{
    const td=document.createElement('td');
    const div=document.createElement('div');div.className='slot';
    if(date){
      const skipped=isSkipped(date);
      const rot=computeRotationDay(date,termStart,startDay);
      const dow=strip(date).getDay();
      if(dow===5&&periodIndex===0){
        const eventsToday=allEvents().filter(ev=>ev.include&&sameDate(date,ev.date)).map(ev=>ev.name);
        const pd=document.createElement('div');pd.className='event-label';pd.textContent=eventsToday.length?eventsToday.join(' / '):'Professional Development';
        div.appendChild(pd);td.appendChild(div);tr.appendChild(td);return;
      }
      if(skipped){
        const names=allEvents().filter(ev=>ev.include&&sameDate(date,ev.date)).map(ev=>ev.name);
        if(names.length){const evDiv=document.createElement('div');evDiv.className='event-label';evDiv.textContent=names.join(' / ');div.appendChild(evDiv);}
      }else{
        const hits=eventsAffecting(date,periodIndex);
        if(hits.length){
          const evDiv=document.createElement('div');evDiv.className='event-label';evDiv.textContent=hits.join(' / ');
          div.appendChild(evDiv);
        }else{
          const s=gridSub[periodIndex]?.[rot-1]||'';
          if(s){
            const base=baseSubject(s);
            const span=document.createElement('span');span.className='hl';span.textContent=s;
            if(base in subjects)span.style.background=subjects[base];
            div.appendChild(span);
            const total=countUnaffectedForBase(base,termStart);
            let count=countSoFarForBase(base,termStart,date);
            // ðŸ©¹ Patch: if this is period 0 (P1), drop the count by 1 (min 1)
            if(periodIndex===0 && count>1) count--;
            const frac=document.createElement('div');frac.className='frac';frac.textContent=`${count}/${total}`;
            div.appendChild(frac);
          }
        }
      }
    }
    td.appendChild(div);tr.appendChild(td);
  });
  return tr;
}
